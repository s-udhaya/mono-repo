# The name of the bundle. run `databricks bundle schema` to see the full bundle settings schema.
bundle:
  name: project2

variables:
  experiment_name:
    description: Experiment name for the model training.
    default: /Users/${workspace.current_user.userName}/${bundle.target}-project2-experiment
  model_name:
    description: Model name for the model training.
    default: project2-model
  input_table_name:
    description: Name of the input table.
    default: product_features

include:
  - ../databricks_resources/ml-artifacts-resource.yml
  - ../databricks_resources/model-workflow-resource.yml
  - ../databricks_resources/model-inference-resource.yml
  - ./databricks_resources/model-workflow-resource.yml

updated_model_training_job: &updated_model_training_job
  model_training_job:
    tasks:
      - task_key: DummyTask
        # job_cluster_key: model_training_job_cluster
        depends_on:
          - task_key: ModelValidation
        notebook_task:
          notebook_path: ../${bundle.name}/steps/validation_step.py
          base_parameters:
            env: ${bundle.target}
            experiment_name: ${var.experiment_name}
            model_name: ${bundle.target}.project1.${var.model_name}
            run_mode: dry_run
            git_source_info: url:${bundle.git.origin_url}; branch:${bundle.git.branch}; commit:${bundle.git.commit}


# Deployment Target specific values for workspace
targets:
  udhay_mlops_dev:  # UC Catalog Name
    default: true
    workspace:
      host: https://adb-984752964297111.11.azuredatabricks.net
    resources:
      jobs:
        <<: *updated_model_training_job

  udhay_mlops_stg:
    workspace:
      host: https://adb-3660789876130739.19.azuredatabricks.net

